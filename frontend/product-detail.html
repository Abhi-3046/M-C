<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - M&C E-Commerce</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">M&C Store</div>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="products.html">Products</a></li>
                <li class="cart-badge">
                    <a href="cart.html">ðŸ›’ Cart</a>
                    <span class="badge" style="display: none;">0</span>
                </li>
                <li class="auth-links">
                    <a href="login.html">Login</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container section">
        <div id="productDetail">
            <div class="loading">
                <div class="spinner"></div>
            </div>
        </div>
    </div>

    <footer
        style="background: rgba(21, 25, 50, 0.8); padding: 3rem 0; margin-top: 4rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
        <div class="container text-center">
            <div class="logo" style="margin-bottom: 1rem; font-size: 2rem;">M&C Store</div>
            <p style="margin-bottom: 1rem;">Your trusted partner for premium devices</p>
            <p style="color: var(--text-secondary); font-size: 0.875rem;">Â© 2026 M&C E-Commerce. All rights reserved.
            </p>
        </div>
    </footer>

    <script src="js/app.js"></script>
    <script>
        async function loadProductDetail() {
            const params = new URLSearchParams(window.location.search);
            const productId = params.get('id');

            if (!productId) {
                window.location.href = 'products.html';
                return;
            }

            const container = document.getElementById('productDetail');

            try {
                const product = await apiCall(`/products/${productId}`);
                const discount = calculateDiscount(product.price, product.discount_price);

                let specificationsHTML = '';
                if (product.specifications && typeof product.specifications === 'object') {
                    specificationsHTML = Object.entries(product.specifications)
                        .map(([key, value]) => `
                            <div style="padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 0.5rem; margin-bottom: 0.5rem;">
                                <strong style="color: var(--accent-cyan); text-transform: capitalize;">${key.replace(/_/g, ' ')}:</strong>
                                <p style="margin-top: 0.5rem;">${value}</p>
                            </div>
                        `).join('');
                }

                container.innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: start;">
                        <div class="glass-card">
                            <img src="${product.image_url}" alt="${product.name}" style="width: 100%; border-radius: 1rem;">
                        </div>
                        
                        <div>
                            <div style="color: var(--accent-cyan); font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.5rem;">
                                ${product.brand}
                            </div>
                            <h1 style="margin-bottom: 1rem;">${product.name}</h1>
                            
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                                <span style="font-size: 2.5rem; font-weight: 700; background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                                    ${formatPrice(product.discount_price || product.price)}
                                </span>
                                ${product.discount_price ? `
                                    <span style="font-size: 1.5rem; color: var(--text-secondary); text-decoration: line-through;">
                                        ${formatPrice(product.price)}
                                    </span>
                                    <span class="discount-badge">${discount}% OFF</span>
                                ` : ''}
                            </div>

                            <p style="margin-bottom: 2rem; line-height: 1.8;">${product.description || ''}</p>

                            <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
                                <input type="number" id="quantity" value="1" min="1" max="${product.stock_quantity}" 
                                       style="width: 80px; padding: 0.75rem; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 0.5rem; color: white; text-align: center;">
                                <button class="btn btn-primary" onclick="addToCartFromDetail()" style="flex: 1;">
                                    Add to Cart
                                </button>
                                <button class="btn btn-secondary" onclick="window.location.href='products.html'">
                                    Continue Shopping
                                </button>
                            </div>

                            <div class="glass-card" style="margin-top: 1rem;">
                                <p style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <span style="font-size: 1.5rem;">ðŸ“¦</span>
                                    <strong>Stock:</strong> ${product.stock_quantity > 0 ?
                        `<span style="color: var(--success)">${product.stock_quantity} units available</span>` :
                        `<span style="color: var(--error)">Out of stock</span>`
                    }
                                </p>
                                <p style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <span style="font-size: 1.5rem;">ðŸšš</span>
                                    <strong>Delivery:</strong> Fast shipping available
                                </p>
                                <p style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.5rem;">âœ…</span>
                                    <strong>Warranty:</strong> 1 Year Manufacturer Warranty
                                </p>
                            </div>

                            ${specificationsHTML ? `
                                <div style="margin-top: 2rem;">
                                    <h2>Specifications</h2>
                                    <div style="margin-top: 1rem;">
                                        ${specificationsHTML}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;

                window.currentProduct = product;
            } catch (error) {
                container.innerHTML = `
                    <div class="text-center">
                        <p style="color: var(--error); margin-bottom: 1rem;">Failed to load product details</p>
                        <button class="btn btn-primary" onclick="window.location.href='products.html'">
                            Back to Products
                        </button>
                    </div>
                `;
            }
        }

        function addToCartFromDetail() {
            const quantity = parseInt(document.getElementById('quantity').value);
            if (window.currentProduct) {
                cart.addItem(window.currentProduct, quantity);
            }
        }

        loadProductDetail();
    </script>

    <style>
        @media (max-width: 768px) {
            #productDetail>div {
                grid-template-columns: 1fr !important;
            }
        }
    </style>
</body>

</html>